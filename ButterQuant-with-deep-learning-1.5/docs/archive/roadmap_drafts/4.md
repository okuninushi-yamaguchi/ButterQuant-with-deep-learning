# ğŸš€ ButterQuant é˜¶æ®µ1éƒ¨ç½²æŒ‡å—

## ğŸ“‹ å‰ç½®è¦æ±‚
- Docker Desktopï¼ˆWindows/Macï¼‰æˆ– Docker Engineï¼ˆLinuxï¼‰
- Git
- ä½ çš„ç°æœ‰ä»£ç 

## ğŸ¯ 5æ­¥éƒ¨ç½²ï¼ˆé¢„è®¡30åˆ†é’Ÿï¼‰

### **æ­¥éª¤ 1ï¼šæ›´æ–°é¡¹ç›®æ–‡ä»¶**

```bash
cd ButterQuant

# 1.1 åˆ›å»º docker-compose.ymlï¼ˆè§ Artifactï¼‰
# å¤åˆ¶ "é˜¶æ®µ1ï¼šDocker Compose é…ç½®" çš„å†…å®¹

# 1.2 åˆ›å»º backend/Dockerfile
# å¤åˆ¶ "backend/Dockerfile" çš„å†…å®¹

# 1.3 æ›´æ–° backend/app.py
# å¤åˆ¶ "backend/app.pyï¼ˆä¼˜åŒ–ç‰ˆï¼‰" çš„å†…å®¹

# 1.4 æ›´æ–° backend/database.py
# å¤åˆ¶ "backend/database.pyï¼ˆä¼˜åŒ–ç‰ˆï¼‰" çš„å†…å®¹
```

---

### **æ­¥éª¤ 2ï¼šæ›´æ–° requirements.txt**

åœ¨ `backend/requirements.txt` æœ«å°¾æ·»åŠ ï¼š
```
gunicorn==21.2.0
gevent==23.9.1
redis==5.0.1
```

---

### **æ­¥éª¤ 3ï¼šå¯åŠ¨æœåŠ¡**

```bash
# æ„å»ºå¹¶å¯åŠ¨æ‰€æœ‰æœåŠ¡
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f backend
```

é¢„æœŸè¾“å‡ºï¼š
```
âœ… Redis started on port 6379
âœ… Backend started on port 5000 with 4 workers
```

---

### **æ­¥éª¤ 4ï¼šæµ‹è¯•æ€§èƒ½**

æ‰“å¼€æµè§ˆå™¨è®¿é—®ï¼š
- **å‰ç«¯**ï¼š`http://localhost:3000`ï¼ˆä½ çš„ React å¼€å‘æœåŠ¡å™¨ä»ç„¶å•ç‹¬è¿è¡Œï¼‰
- **åç«¯å¥åº·æ£€æŸ¥**ï¼š`http://localhost:5000/api/health`

**ç¬¬ä¸€æ¬¡åˆ†æ**ï¼ˆæ— ç¼“å­˜ï¼‰ï¼š
```bash
curl -X POST http://localhost:5000/api/analyze \
  -H "Content-Type: application/json" \
  -d '{"ticker": "AAPL"}'
```
é¢„æœŸå“åº”æ—¶é—´ï¼š**5-10ç§’**

**ç¬¬äºŒæ¬¡åˆ†æ**ï¼ˆå‘½ä¸­ç¼“å­˜ï¼‰ï¼š
```bash
# å†æ¬¡è¯·æ±‚åŒä¸€è‚¡ç¥¨
curl -X POST http://localhost:5000/api/analyze \
  -H "Content-Type: application/json" \
  -d '{"ticker": "AAPL"}'
```
é¢„æœŸå“åº”æ—¶é—´ï¼š**< 100ms** âœ…

---

### **æ­¥éª¤ 5ï¼šæŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡**

```bash
curl http://localhost:5000/api/cache/stats
```

é¢„æœŸè¾“å‡ºï¼š
```json
{
  "total_connections": 15,
  "keyspace_hits": 10,
  "keyspace_misses": 5,
  "hit_rate": 66.67,  // ç¼“å­˜å‘½ä¸­ç‡
  "used_memory_human": "2.5M",
  "total_keys": 12
}
```

---

## ğŸ¯ æ€§èƒ½å¯¹æ¯”

| æŒ‡æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å | æå‡ |
|------|--------|--------|------|
| **é¦–æ¬¡åˆ†æ** | 5-15ç§’ | 5-10ç§’ | æ— å˜åŒ–ï¼ˆè®¡ç®—å¯†é›†ï¼‰ |
| **ç¼“å­˜å‘½ä¸­** | 5-15ç§’ | < 100ms | **50-150å€** âœ… |
| **å¹¶å‘èƒ½åŠ›** | 1-2 | 50-100 | **50å€** âœ… |
| **å†…å­˜å ç”¨** | ~200MB | ~400MB | +200MBï¼ˆRedisï¼‰ |

---

## ğŸ”§ è°ƒä¼˜å‚æ•°

### **è°ƒæ•´ç¼“å­˜æ—¶é—´**ï¼ˆæ ¹æ®å¸‚åœºå¼€ç›˜æ—¶é—´ï¼‰
```yaml
# docker-compose.yml
environment:
  - CACHE_TTL=300  # 5åˆ†é’Ÿï¼ˆç›˜ä¸­ï¼‰
  # ç›˜åå¯ä»¥å»¶é•¿åˆ° 3600ï¼ˆ1å°æ—¶ï¼‰
```

### **è°ƒæ•´ Worker æ•°é‡**ï¼ˆæ ¹æ® CPU æ ¸å¿ƒæ•°ï¼‰
```yaml
# docker-compose.yml
environment:
  - WORKERS=4  # æ¨è = CPU æ ¸å¿ƒæ•°
```

æŸ¥çœ‹ä½ çš„ CPU æ ¸å¿ƒæ•°ï¼š
```bash
# Windows (PowerShell)
(Get-WmiObject Win32_Processor).NumberOfLogicalProcessors

# Linux/Mac
nproc
```

---

## ğŸ› å¸¸è§é—®é¢˜

### **Q1: Redis è¿æ¥å¤±è´¥**
```
redis.exceptions.ConnectionError: Error connecting to Redis
```

**è§£å†³æ–¹æ¡ˆ**ï¼š
```bash
# æ£€æŸ¥ Redis æ˜¯å¦è¿è¡Œ
docker ps | grep redis

# é‡å¯ Redis
docker-compose restart redis
```

---

### **Q2: ç¼“å­˜ä¸ç”Ÿæ•ˆ**
æ£€æŸ¥ Redis æ˜¯å¦æ­£å¸¸ï¼š
```bash
docker exec -it butterquant_redis redis-cli

# åœ¨ Redis CLI ä¸­æ‰§è¡Œ
PING  # åº”è¯¥è¿”å› PONG
KEYS *  # æŸ¥çœ‹æ‰€æœ‰ç¼“å­˜é”®
```

---

### **Q3: æ•°æ®åº“é”è¡¨**
```
sqlite3.OperationalError: database is locked
```

**è§£å†³æ–¹æ¡ˆ**ï¼šWAL æ¨¡å¼å·²è‡ªåŠ¨å¯ç”¨ï¼Œå¦‚æœä»æœ‰é—®é¢˜ï¼š
```bash
# è¿›å…¥å®¹å™¨
docker exec -it butterquant_backend bash

# æ£€æŸ¥æ•°æ®åº“æ¨¡å¼
sqlite3 data/history.db "PRAGMA journal_mode;"
# åº”è¯¥è¾“å‡º "wal"
```

---

## ğŸ“Š ç›‘æ§å‘½ä»¤

### **æŸ¥çœ‹å®æ—¶æ—¥å¿—**
```bash
docker-compose logs -f backend
```

### **æŸ¥çœ‹èµ„æºå ç”¨**
```bash
docker stats butterquant_backend butterquant_redis
```

---

## ğŸ“ ä¸‹ä¸€æ­¥ä¼˜åŒ–ï¼ˆå¯é€‰ï¼‰

å¦‚æœä½ å‘ç°ç¼“å­˜å‘½ä¸­ç‡ < 50%ï¼Œå¯ä»¥ï¼š
1. **å»¶é•¿ç¼“å­˜æ—¶é—´**ï¼ˆç›˜åå¸‚åœºï¼‰
2. **é¢„åŠ è½½çƒ­é—¨è‚¡ç¥¨**ï¼ˆå®šæ—¶ä»»åŠ¡ï¼‰
3. **æ·»åŠ å¤šçº§ç¼“å­˜**ï¼ˆæµè§ˆå™¨ LocalStorageï¼‰

æˆ‘å¯ä»¥å¸®ä½ å®ç°è¿™äº›åŠŸèƒ½ï¼